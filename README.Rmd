---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# gdt

<!-- badges: start -->
<!-- badges: end -->

The goal of `gdt` is to make `data.table` easier to use.

## Installation

You can install the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("mtfairbanks/gdt")
```

## Functions

#### Inside a data.table call
* `list()`: Select column(s)
* `let()`: Add column(s)
* `order()`: Order rows
* `agg()`: Apply aggregation functions

#### Helper functions
* `as_dt()`: Safely operate on data.tables without altering the original object. Also converts data.frames to data.tables.
* `dt_pivot_longer()` & `dt_pivot_wider()`
* `dt_case_when()`
* `dt_left_join()`, `dt_inner_join()`, etc.
* `dt_rename()`
* `dt_count()`
* `let_if()` & `let_at()`: Equivalent to `mutate_if()` & `mutate_at()`
* `%notin%`
* `dt()`: Pipeable `data.table` call. *See example below*

## General syntax

The code chunk below shows the `gdt` syntax:

```{r message = FALSE}
library(gdt) # Loads data.table, %>%, purrr, and stringr

example_dt <- data.table(x = c(1,2,3), y = c(4,5,6), z = c("a", "a", "b"))

example_dt %>%
  as_dt() %>% # Safely operate on data.tables/convert data.frames to data.tables
  .[, list(x, y, z)] %>% # Select columns
  .[x < 4 & y > 1] %>% # Filter columns
  .[order(x, y)] %>% # Reorder columns
  .[, let(double_x = x * 2,
          double_y = y * 2)] %>% # Add columns
  .[, agg(avg_x = mean(x)), by = z] %>% # Summarize/aggregate data
  dt_rename(new_z = z,
            new_avg_x = avg_x) # Rename one or multiple columns
```

#### dt() helper

The `dt()` function makes `data.table` easily pipeable:

```{r}
example_dt <- data.table(x = c(1,2,3), y = c(4,5,6), z = c("a", "a", "b"))

example_dt %>%
  as_dt() %>%
  dt(, list(x, y, z)) %>%
  dt(x < 4 & y > 1) %>%
  dt(order(x, y)) %>%
  dt(, let(double_x = x * 2,
           double_y = y * 2)) %>%
  dt(, agg(avg_x = mean(x)), by = z)
```
