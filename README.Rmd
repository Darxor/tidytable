---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# gdt

<!-- badges: start -->
<!-- badges: end -->

The goal of `gdt` is to complement [`tidyfast`](https://github.com/TysonStanley/tidyfast) and [`maditr`](https://github.com/gdemin/maditr) as a tidy interface to `data.table`.

## Installation

You can install the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("mtfairbanks/gdt")
```

## Functions

#### maditr functions
* `dt_mutate()`
* `dt_select()`
* `dt_filter()`
* `dt_arrange()`
* `dt_summarize()`
* `dt_left_join()`, `dt_inner_join()`, etc.

#### gdt functions

* `as_dt()`: Safely operate on data.tables without altering the original object. Also converts data.frames to data.tables.
* `dt_rename()`
* `dt_mutate_if()` & `dt_mutate_at()`
* `%notin%`
* `dt()`: Pipeable `data.table` call. [See example here](https://github.com/mtfairbanks/gdt#dt-helper)

#### tidyfast functions
* `dt_case_when()`
* `dt_pivot_longer()` & `dt_pivot_wider()`: `gdt` functions recently accepted to `tidyfast`!
* `dt_count()` & `dt_uncount()`
* `dt_separate()`
* `dt_nest()` & `dt_unnest()`
* `dt_fill()`

## General syntax

The code chunk below shows the `gdt` syntax combined with `maditr`:

```{r message = FALSE}
library(gdt) # Loads data.table and %>%
library(maditr)
library(tidyfast)

example_dt <- data.table(x = c(1,2,3), y = c(4,5,6), z = c("a", "a", "b"))

example_dt %>%
  as_dt() %>% # Safely operate on data.tables/convert data.frames to data.tables
  dt_select(x, y, z) %>%
  dt_filter(x < 4 & y > 1) %>%
  dt_arrange(x, y) %>%
  dt_mutate(double_x = x * 2,
            double_y = y * 2) %>%
  dt_mutate_if(is.character, as.factor) %>%
  dt_summarize(avg_x = mean(x), by = z) %>%
  dt_rename(new_z = z,
            new_avg_x = avg_x) # Rename one or multiple columns
```

#### `dt()` helper

The `dt()` function makes `data.table` syntax pipeable:

```{r}
example_dt <- data.table(x = c(1,2,3), y = c(4,5,6), z = c("a", "a", "b"))

example_dt %>%
  as_dt() %>%
  dt(, list(x, y, z)) %>%
  dt(x < 4 & y > 1) %>%
  dt(order(x, y)) %>%
  dt(, ':='(double_x = x * 2,
            double_y = y * 2)) %>%
  dt(, list(avg_x = mean(x)), by = z)
```
